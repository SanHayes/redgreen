import{c as E,d as M,e as x,h as s,M as S,aA as R,aB as T,y as D,D as K,ak as O,r as f,k as j,E as y,J as C,H as d,F as I,I as _,U as q,G as h,S as G,N as V,Q as H}from"./index-7c2b3931.js";import{C as J}from"./index-fd45ea3a.js";import"./index-27a55b57.js";import"./index-66bf4a08.js";import{F as P}from"./index-ed084836.js";import{N as Q}from"./index-c0175f7a.js";import{A as W}from"./AreaSelect-ce328bdd.js";import{l as X,L as Y}from"./user-02900f6d.js";import{_ as Z,I as ee}from"./_plugin-vue_export-helper-d9753a3e.js";import{O as ae}from"./index-7047aa76.js";import{a as $}from"./function-call-d2a53b5c.js";import{B as oe}from"./index-f9e2e701.js";import"./use-expose-7cf3d07e.js";import"./use-id-bf35341c.js";import"./use-placeholder-6fc5606a.js";import"./index-aca95857.js";import"./index-995b9d95.js";import"./http-eade67d5.js";import"./use-touch-b4041db2.js";const[b,te]=E("space"),ne={align:String,direction:{type:String,default:"horizontal"},size:{type:[Number,String,Array],default:8},wrap:Boolean,fill:Boolean};function z(o=[]){const l=[];return o.forEach(t=>{Array.isArray(t)?l.push(...t):t.type===S?l.push(...z(t.children)):l.push(t)}),l.filter(t=>{var p;return!(t&&(t.type===R||t.type===S&&((p=t.children)==null?void 0:p.length)===0||t.type===T&&t.children.trim()===""))})}var se=M({name:b,props:ne,setup(o,{slots:l}){const t=x(()=>{var e;return(e=o.align)!=null?e:o.direction==="horizontal"?"center":""}),p=e=>typeof e=="number"?e+"px":e,g=e=>{const i={},u=`${p(Array.isArray(o.size)?o.size[0]:o.size)}`,m=`${p(Array.isArray(o.size)?o.size[1]:o.size)}`;return e?o.wrap?{marginBottom:m}:{}:(o.direction==="horizontal"&&(i.marginRight=u),(o.direction==="vertical"||o.wrap)&&(i.marginBottom=m),i)};return()=>{var e;const i=z((e=l.default)==null?void 0:e.call(l));return s("div",{class:[te({[o.direction]:o.direction,[`align-${t.value}`]:t.value,wrap:o.wrap,fill:o.fill})]},[i.map((u,m)=>s("div",{key:`item-${m}`,class:`${b}-item`,style:g(m===i.length-1)},[u]))])}}});const le=D(se);const re={class:"container"},ie={class:"field-wrap"},me={class:"value"},ue={class:"field-wrap"},ce={class:"links"},de={class:"loading"},pe={__name:"Login",setup(o){const{t:l}=K(),t=O(),p=()=>history.back(),g=f(0),e=j({username:"",password:""}),i=f({areaCodes:null,dialCode:"1",iso2:"us",name:"United States",priority:0}),u=f(!0),m=f(!1),w=f(!1),A=()=>{m.value=!0},B=()=>{if(!e.username){let a=l("login.inpemail");g.value===1&&(a=l("login.phonenum")),$({message:a});return}if(!e.password){$({message:l("login.inppass")});return}w.value=!0,X(e).then(a=>{w.value=!1,console.log("/api/users/login",a);const{access_token:n,token:k}=a;localStorage.setItem("token",k);let c="emailvalue",v="emailpass";g.value===1&&(c="phonevalue",v="phonepass"),u.value===!0?(localStorage.setItem(c,e.username),localStorage.setItem(v,e.password)):(localStorage.removeItem(c),localStorage.removeItem(v)),t.push({path:"/"})}).catch(a=>{console.log(a),$({message:a.msg})}),H(()=>{if(u.value){const a=localStorage.getItem("emailvalue"),n=localStorage.getItem("emailpass");e.username=a,e.password=n}})};return(a,n)=>{const k=Q,c=ee,v=P,N=J,U=oe,L=Y,F=ae;return y(),C(S,null,[s(k,{title:a.$t("login.login"),"left-arrow":"",onClickLeft:p},null,8,["title"]),d("div",re,[d("div",ie,[g.value===0?(y(),I(c,{key:0,size:"20","class-prefix":"iconfont",name:"icon-youjian"})):(y(),I(c,{key:1,size:"20","class-prefix":"iconfont",name:"icon-mobile"})),g.value===1?(y(),C("div",{key:2,class:"area",onClick:A},[d("div",me,"+"+_(i.value.dialCode),1),s(c,{name:"arrow-down"})])):q("",!0),s(v,{modelValue:e.username,"onUpdate:modelValue":n[0]||(n[0]=r=>e.username=r),placeholder:g.value===0?a.$t("login.inpemail"):a.$t("login.phonenum")},null,8,["modelValue","placeholder"])]),d("div",ue,[s(c,{size:"20","class-prefix":"iconfont",name:"icon-password"}),s(v,{type:"password",modelValue:e.password,"onUpdate:modelValue":n[1]||(n[1]=r=>e.password=r),placeholder:a.$t("login.inppass")},null,8,["modelValue","placeholder"])]),s(N,{class:"remember",shape:"square",modelValue:u.value,"onUpdate:modelValue":n[2]||(n[2]=r=>u.value=r)},{default:h(()=>[V(_(a.$t("login.rempass")),1)]),_:1},8,["modelValue"]),s(G(le),{direction:"vertical",size:20},{default:h(()=>[s(U,{type:"primary",block:"",round:"",onClick:B},{default:h(()=>[V(_(a.$t("login.login")),1)]),_:1})]),_:1}),d("div",ce,[d("span",{onClick:n[3]||(n[3]=r=>a.$router.push({path:"/register"}))},_(a.$t("login.register")),1),d("span",{onClick:n[4]||(n[4]=r=>a.$router.push({path:"/forget"}))},_(a.$t("login.forget")),1)])]),s(W,{show:m.value,"onUpdate:show":n[5]||(n[5]=r=>m.value=r),code:i.value,"onUpdate:code":n[6]||(n[6]=r=>i.value=r)},null,8,["show","code"]),s(F,{show:w.value},{default:h(()=>[d("div",de,[s(L,{type:"spinner"})])]),_:1},8,["show"])],64)}}},Le=Z(pe,[["__scopeId","data-v-e45e9d17"]]);export{Le as default};
